#!/bin/sh
# path logic inspired by https://github.com/stedolan/jq/issues/243
JQ_REPL_JQ="${JQ_REPL_JQ:-jq}"
$JQ_REPL_JQ -r '
[
  path(..) | map(
    if type == "string" and test("[^A-z0-9_]") then
        gsub("^(?<match>.*)$";"[\"\(.match)\"]") 
    else "[]" end)
  | join(".")
] | sort | unique | .[] | split(".[]") | join("[]") | "." + .
'
